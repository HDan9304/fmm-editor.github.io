<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Player Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #101123;
      background-image: radial-gradient(#2b2c3f 1px, transparent 1px);
      background-size: 20px 20px;
      margin: 0; padding: 20px;
      display: flex; justify-content: center; align-items: flex-start;
      min-height: 100vh; color: #f5f5f5;
    }
    .container {
      background: #18192B;
      padding: 20px;
      border-radius: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      max-width: 520px;
      width: 100%;
      display: flex;
      flex-direction: column;
      border: 2px solid #FE6F21;
    }
    h2 {
      margin: 0 0 18px; font-size: 22px; font-weight: 600; text-align: center; color: #fff;
    }
    .field { margin-bottom: 15px; }
    .field label {
      display: block; margin-bottom: 6px;
      font-weight: 500; font-size: 14px; color: #ddd;
    }
    .field label .required { color: #FE6F21; font-weight: bold; }

    .field input, #results {
      width: 100%; padding: 10px;
      border: 1px solid #444; border-radius: 8px;
      font-size: 14px; background: #242537; color: #f5f5f5;
      outline: none;
    }
    .field input:focus, #results:focus {
      border-color: #FE6F21;
      background: #2b2c3f;
      box-shadow: 0 0 6px rgba(254, 111, 33, 0.6);
    }

    .result-label {
      margin: 20px 0 8px; font-size: 15px; font-weight: 600; color: #FE6F21;
    }
    #results {
      font-family: 'Poppins', monospace;
      font-size: 14px; font-weight: 500;
      white-space: pre-wrap; line-height: 1.6;
      padding: 16px 12px;
      min-height: 120px; max-height: 300px; overflow-y: auto;
      margin-bottom: 15px;
    }

    .btn {
      background: #FE6F21; border: none; color: white;
      padding: 12px; border-radius: 8px;
      font-size: 14px; font-weight: 600;
      cursor: pointer; text-align: center;
    }
    .btn:hover { background: #ff7f3b; }
    .btn-secondary {
      background: transparent; border: 2px solid #FE6F21; color: #FE6F21;
    }
    .btn-secondary:hover { background: rgba(254,111,33,0.08); }
    .full-width { width: 100%; }
    .actions-row { display: flex; gap: 10px; }
    .actions-row .btn { flex: 1; }
    .copy-status { margin-top: 6px; font-size: 12px; color: #9ad29a; min-height: 16px; }

    /* Combo with logo inside input */
    .combo { position: relative; }
    .combo input {
      width: 100%; padding: 10px 10px 10px 40px;
      border: 1px solid #444; border-radius: 8px;
      background: #242537; color: #f5f5f5;
    }
    .combo-logo {
      position: absolute; top: 50%; left: 10px; transform: translateY(-50%);
      width: 20px; height: 20px;
      border-radius: 50%; object-fit: contain;
      background: #18192B; border: 1px solid #3a3b4f;
      display: none;
    }
    .combo-panel {
      position: absolute; left: 0; right: 0; top: calc(100% + 6px);
      background: #242537; border: 1px solid #444;
      border-radius: 10px; box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      max-height: 260px; overflow-y: auto; padding: 6px;
      display: none; z-index: 999;
    }
    .combo.open .combo-panel { display: block; }
    .combo-item {
      display: flex; align-items: center; gap: 10px;
      padding: 8px 10px; border-radius: 8px;
      cursor: pointer; font-size: 14px; color: #f5f5f5;
    }
    .combo-item:hover, .combo-item.active { background: #2b2c3f; outline: 1px solid #FE6F21; }
    .combo-item img {
      width: 22px; height: 22px; border-radius: 4px;
      object-fit: contain; background: #18192B; border: 1px solid #3a3b4f;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Player Data Input</h2>

    <!-- Basic fields -->
    <div class="field"><label>First Name <span class="required">*</span></label><input id="firstName"></div>
    <div class="field"><label>Last Name <span class="required">*</span></label><input id="lastName"></div>

    <!-- Current Club -->
    <div class="field">
      <label>Current Club <span class="required">*</span></label>
      <div class="combo" id="comboCurrent">
        <img id="logoCurrent" class="combo-logo" alt="">
        <input id="currentClub" placeholder="Search club…" autocomplete="off">
        <div class="combo-panel"></div>
      </div>
    </div>

    <!-- New Club -->
    <div class="field">
      <label>New Club</label>
      <div class="combo" id="comboNew">
        <img id="logoNew" class="combo-logo" alt="">
        <input id="newClub" placeholder="Search club…" autocomplete="off">
        <div class="combo-panel"></div>
      </div>
    </div>

    <!-- Other fields -->
    <div class="field"><label>New First Name</label><input id="newFirstName"></div>
    <div class="field"><label>New Last Name</label><input id="newLastName"></div>
    <div class="field"><label>New Short Name</label><input id="newShortName"></div>
    <div class="field"><label>Year of Birth</label><input type="number" id="yearOfBirth"></div>
    <div class="field"><label>CA (0–100)</label><input type="number" id="ca" min="0" max="100"></div>
    <div class="field"><label>PA (0–100)</label><input type="number" id="pa" min="0" max="100"></div>

    <!-- Results -->
    <div class="result-label">Results</div>
    <div id="results" contenteditable="true"></div>

    <!-- Buttons -->
    <button class="btn full-width" onclick="addResult()">Add Result</button>
    <div class="actions-row">
      <button class="btn" onclick="copyResults()">Copy All</button>
      <button class="btn btn-secondary" onclick="clearResults()">Clear</button>
    </div>
    <div id="copyStatus" class="copy-status"></div>
  </div>

  <script>
    const STORAGE_KEY = "playerEditorResults";
    const FALLBACK_LOGO =
      'data:image/svg+xml;utf8,' +
      encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><rect width="100%" height="100%" fill="#18192B"/><circle cx="32" cy="32" r="20" fill="#FE6F21"/></svg>');

    const clubs = [
      { name: "Barcelona", logo: "https://upload.wikimedia.org/wikipedia/en/4/47/FC_Barcelona_%28crest%29.svg" },
      { name: "Real Madrid", logo: "https://upload.wikimedia.org/wikipedia/en/5/56/Real_Madrid_CF.svg" },
      { name: "Manchester United", logo: "https://upload.wikimedia.org/wikipedia/en/7/7a/Manchester_United_FC_crest.svg" },
      { name: "Liverpool", logo: "https://upload.wikimedia.org/wikipedia/en/0/0c/Liverpool_FC.svg" }
    ];

    function capWords(str) {
      return String(str||"").trim().replace(/\b([a-zA-Z])/g, m => m.toUpperCase());
    }
    function convertTo200(v) {
      if (!v) return "";
      const n = Math.max(0, Math.min(100, Number(v)));
      return Math.round((n/100)*200);
    }
    function buildResult() {
      const g=id=>document.getElementById(id).value.trim();
      const first=capWords(g("firstName")), last=capWords(g("lastName")), currentClub=capWords(g("currentClub"));
      if(!first||!last||!currentClub) return "";
      return `"PLAYER" "${first}" "${last}" "${currentClub}" "${capWords(g("newFirstName"))}" "${capWords(g("newLastName"))}" "${capWords(g("newShortName"))}" "${g("yearOfBirth")}" "${convertTo200(g("ca"))}" "${convertTo200(g("pa"))}" "${capWords(g("newClub"))}"`;
    }
    function addResult(){
      const res=document.getElementById("results"), line=buildResult();
      if(line){ res.textContent+=(res.textContent?"\n":"")+line; save(); res.scrollTop=res.scrollHeight; }
      else alert("Fill in First Name, Last Name, and Current Club.");
    }
    function copyResults(){
      const text=document.getElementById("results").textContent.trim();
      if(text){ navigator.clipboard.writeText(text).then(()=>setCopyStatus("Copied ✅")); }
    }
    function clearResults(){ document.getElementById("results").textContent=""; save(); setCopyStatus(""); }
    function save(){ localStorage.setItem(STORAGE_KEY, document.getElementById("results").textContent); }
    function load(){ const saved=localStorage.getItem(STORAGE_KEY); if(saved) document.getElementById("results").textContent=saved; }
    function setCopyStatus(msg){ document.getElementById("copyStatus").textContent=msg; }

    function initCombo(comboId,inputId,logoId){
      const combo=document.getElementById(comboId), input=document.getElementById(inputId), logo=document.getElementById(logoId), panel=combo.querySelector(".combo-panel");
      let items=[],active=-1;
      function open(){combo.classList.add("open");}
      function close(){combo.classList.remove("open");}
      function render(list){
        panel.innerHTML=""; items=list;
        list.forEach((c,i)=>{
          const div=document.createElement("div"); div.className="combo-item";
          const img=document.createElement("img"); img.src=c.logo||FALLBACK_LOGO; img.onerror=()=>img.src=FALLBACK_LOGO;
          const span=document.createElement("span"); span.textContent=c.name;
          div.append(img,span); div.onclick=()=>select(c); panel.appendChild(div);
        });
      }
      function select(club){
        input.value=club.name; logo.style.display="block"; logo.src=club.logo||FALLBACK_LOGO; close();
      }
      input.addEventListener("focus",()=>{render(clubs); open();});
      input.addEventListener("input",()=>{logo.style.display="none"; render(clubs.filter(c=>c.name.toLowerCase().includes(input.value.toLowerCase()))); open();});
      document.addEventListener("click",e=>{if(!combo.contains(e.target)) close();});
    }

    initCombo("comboCurrent","currentClub","logoCurrent");
    initCombo("comboNew","newClub","logoNew");
    window.onload=load;
  </script>
</body>
</html>
