<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Player Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #101123;
      background-image: radial-gradient(#2b2c3f 1px, transparent 1px);
      background-size: 20px 20px;
      margin: 0; padding: 20px;
      display: flex; justify-content: center; align-items: flex-start;
      min-height: 100vh; color: #f5f5f5;
    }
    .container {
      background: #18192B; padding: 20px;
      border-radius: 14px; box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      max-width: 520px; width: 100%; display: flex; flex-direction: column;
      border: 2px solid #FE6F21;
    }
    h2 { margin: 0 0 18px; font-size: 22px; font-weight: 600; color: #fff; text-align: center; }
    .field { margin-bottom: 15px; }
    .field label { display: block; margin-bottom: 6px; font-weight: 500; color: #ddd; font-size: 14px; }
    .field label .required { color: #FE6F21; font-weight: bold; }
    .field input, #results {
      width: 100%; padding: 10px; border: 1px solid #444; border-radius: 8px;
      font-size: 14px; background: #242537; color: #f5f5f5; outline: none;
    }
    .field input:focus, #results:focus { border-color: #FE6F21; background: #2b2c3f; box-shadow: 0 0 6px rgba(254,111,33,0.6); }
    .hint { font-size: 12px; color: #bdbdbd; margin-top: 4px; }
    .result-label { margin: 20px 0 8px; font-size: 15px; font-weight: 600; color: #FE6F21; }
    #results {
      font-family: 'Poppins', monospace; font-size: 14px;
      min-height: 120px; max-height: 300px; overflow-y: auto;
      line-height: 1.6; padding: 16px 12px; white-space: pre-wrap;
    }
    .btn {
      background: #FE6F21; border: none; color: white; padding: 12px;
      border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer;
    }
    .btn:hover { background: #ff7f3b; }
    .btn-secondary { background: transparent; border: 2px solid #FE6F21; color: #FE6F21; }
    .btn-secondary:hover { background: rgba(254,111,33,0.08); }
    .full-width { width: 100%; }
    .actions-row { display: flex; gap: 10px; margin-top: 6px; }
    .copy-status { margin-top: 6px; font-size: 12px; color: #9ad29a; min-height: 16px; }

    /* Combo dropdown styles */
    .combo { position: relative; }
    .combo-panel {
      position: absolute; top: calc(100% + 6px); left: 0; right: 0;
      background: #242537; border: 1px solid #444; border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      max-height: 260px; overflow-y: auto; padding: 6px;
      display: none; z-index: 999;
    }
    .combo.open .combo-panel { display: block; }
    .combo-item {
      display: flex; align-items: center; gap: 10px;
      padding: 8px 10px; border-radius: 8px; cursor: pointer; font-size: 14px;
    }
    .combo-item:hover, .combo-item.active { background: #2b2c3f; outline: 1px solid #FE6F21; }
    .combo-item img { width: 22px; height: 22px; border-radius: 4px; object-fit: contain; background: #18192B; }
    .club-chip {
      margin-top: 8px; display: inline-flex; align-items: center; gap: 8px;
      background: #242537; border: 1px solid #444;
      padding: 6px 10px; border-radius: 999px; font-size: 13px; color: #ddd;
    }
    .club-chip img { width: 20px; height: 20px; border-radius: 50%; object-fit: contain; background: #18192B; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Player Data Input</h2>

    <!-- Basic fields -->
    <div class="field"><label>First Name <span class="required">*</span></label><input id="firstName"></div>
    <div class="field"><label>Last Name <span class="required">*</span></label><input id="lastName"></div>

    <!-- Current Club -->
    <div class="field">
      <label>Current Club <span class="required">*</span></label>
      <div class="combo" id="comboCurrent"><input id="currentClub" placeholder="Search club…"><div class="combo-panel"></div></div>
      <div id="chipCurrent" class="club-chip" style="display:none;"><img><span></span></div>
    </div>

    <!-- New Club -->
    <div class="field">
      <label>New Club</label>
      <div class="combo" id="comboNew"><input id="newClub" placeholder="Search club…"><div class="combo-panel"></div></div>
      <div id="chipNew" class="club-chip" style="display:none;"><img><span></span></div>
    </div>

    <!-- Other fields -->
    <div class="field"><label>New First Name</label><input id="newFirstName"></div>
    <div class="field"><label>New Last Name</label><input id="newLastName"></div>
    <div class="field"><label>New Short Name</label><input id="newShortName"></div>
    <div class="field"><label>Year of Birth</label><input type="number" id="yearOfBirth"></div>
    <div class="field"><label>CA (0–100)</label><input type="number" id="ca"></div>
    <div class="field"><label>PA (0–100)</label><input type="number" id="pa"></div>

    <!-- Results -->
    <div class="result-label">Results</div>
    <div id="results" contenteditable="true"></div>
    <button class="btn full-width" onclick="addResult()">Add Result</button>
    <div class="actions-row">
      <button class="btn" onclick="copyResults()">Copy All</button>
      <button class="btn btn-secondary" onclick="clearResults()">Clear</button>
    </div>
    <div id="copyStatus" class="copy-status"></div>
  </div>

  <script>
    const STORAGE_KEY = "playerResults";
    const clubs = [
      { name: "Barcelona", logo: "https://upload.wikimedia.org/wikipedia/en/4/47/FC_Barcelona_%28crest%29.svg" },
      { name: "Real Madrid", logo: "https://upload.wikimedia.org/wikipedia/en/5/56/Real_Madrid_CF.svg" },
      { name: "Manchester United", logo: "https://upload.wikimedia.org/wikipedia/en/7/7a/Manchester_United_FC_crest.svg" },
      { name: "Liverpool", logo: "https://upload.wikimedia.org/wikipedia/en/0/0c/Liverpool_FC.svg" }
    ];
    const fallback = "data:image/svg+xml;utf8," + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><rect width="100%" height="100%" fill="#18192B"/><circle cx="32" cy="32" r="20" fill="#FE6F21"/></svg>');

    function buildResult() {
      const f = id=>document.getElementById(id).value.trim();
      if(!f("firstName")||!f("lastName")||!f("currentClub")) return "";
      const scale=v=>v?Math.round(Math.min(100,Math.max(0,Number(v)))/100*200):"";
      return `"PLAYER" "${f("firstName")}" "${f("lastName")}" "${f("currentClub")}" "${f("newFirstName")}" "${f("newLastName")}" "${f("newShortName")}" "${f("yearOfBirth")}" "${scale(f("ca"))}" "${scale(f("pa"))}" "${f("newClub")}"`;
    }
    function addResult(){const r=document.getElementById("results");const line=buildResult();if(line){r.textContent+=(r.textContent?"\n":"")+line;localStorage.setItem(STORAGE_KEY,r.textContent);}}
    function copyResults(){navigator.clipboard.writeText(document.getElementById("results").textContent);}
    function clearResults(){document.getElementById("results").textContent="";localStorage.removeItem(STORAGE_KEY);}
    window.onload=()=>{document.getElementById("results").textContent=localStorage.getItem(STORAGE_KEY)||"";}

    /* Generic dropdown builder for Current/New club */
    function initCombo(comboId,inputId,chipId){
      const combo=document.getElementById(comboId);
      const input=document.getElementById(inputId);
      const panel=combo.querySelector(".combo-panel");
      const chip=document.getElementById(chipId);
      const chipImg=chip.querySelector("img");
      const chipSpan=chip.querySelector("span");
      let visible=[],active=-1;
      function render(list){
        panel.innerHTML="";visible=list;
        list.forEach((c,i)=>{
          const item=document.createElement("div");item.className="combo-item";item.dataset.index=i;
          const img=document.createElement("img");img.src=c.logo||fallback;img.onerror=()=>img.src=fallback;
          const span=document.createElement("span");span.textContent=c.name;
          item.append(img,span);item.onclick=()=>select(i);panel.appendChild(item);
        });
      }
      function select(i){
        const c=visible[i];input.value=c.name;chip.style.display="inline-flex";chipImg.src=c.logo||fallback;chipSpan.textContent=c.name;panel.style.display="none";
      }
      input.onfocus=()=>{render(clubs);panel.style.display="block";};
      input.oninput=()=>{render(clubs.filter(c=>c.name.toLowerCase().includes(input.value.toLowerCase())));panel.style.display="block";chip.style.display="none";};
      document.addEventListener("click",e=>{if(!combo.contains(e.target))panel.style.display="none";});
    }
    initCombo("comboCurrent","currentClub","chipCurrent");
    initCombo("comboNew","newClub","chipNew");
  </script>
</body>
</html>
