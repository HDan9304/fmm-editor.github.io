<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Player Editor (Main + Reserves)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#101123;           /* page bg */
      --card:#18192B;         /* container */
      --field:#242537;        /* input bg */
      --ink:#f5f5f5;          /* text */
      --muted:#bdbddd;        /* helper text */
      --accent:#FE6F21;       /* orange accent */
      --border:#2e2f45;
    }
    *{ box-sizing:border-box }
    body{
      font-family:'Poppins',sans-serif;
      background: radial-gradient(#2b2c3f 1px, transparent 1px) 0 0/20px 20px, var(--bg);
      margin:0; padding:20px; min-height:100vh;
      display:flex; justify-content:center; align-items:flex-start; color:var(--ink);
    }
    .container{
      width:100%; max-width:520px; background:var(--card);
      border:2px solid var(--accent); border-radius:16px;
      box-shadow:0 6px 18px rgba(0,0,0,.35);
      padding:18px; display:flex; flex-direction:column; gap:14px;
    }
    h2{ margin:0; text-align:center; font-size:22px; font-weight:600 }
    .field{ display:flex; flex-direction:column; gap:6px }
    .label{ font-size:13px; color:#e9e9f5 }
    .required{ color:var(--accent); font-weight:700; margin-left:4px }
    .hint{ font-size:12px; color:var(--muted) }

    input[type="text"], input[type="number"]{
      width:100%; padding:10px 12px; border-radius:10px;
      border:1px solid var(--border); background:var(--field); color:var(--ink);
      font-size:14px; outline:none; transition:border-color .2s, box-shadow .2s, background .2s;
      text-transform:capitalize;  /* visual capitalization */
    }
    input[type="text"]:focus, input[type="number"]:focus, #result:focus{
      border-color:var(--accent); background:#2b2c3f; box-shadow:0 0 6px rgba(254,111,33,.5);
    }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
    .split-2{ display:grid; grid-template-columns:1fr 1fr; gap:12px }
    @media (max-width:480px){ .split-2{ grid-template-columns:1fr } }

    .options{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      padding:10px; border:1px solid var(--border); border-radius:12px; background:#1f2136;
    }
    .options .spacer{ flex:1 }
    .switch{
      display:inline-flex; align-items:center; gap:8px; font-size:13px; color:#e9e9f5;
    }
    .switch input{ transform:scale(1.1) }

    .result-label{ margin-top:6px; font-weight:600; color:var(--accent) }
    #result{
      white-space:pre-wrap; word-break:break-word;
      min-height:140px; padding:14px; border-radius:12px;
      border:1px solid var(--border); background:var(--field);
      font-size:14px; font-family:'Poppins',monospace; outline:none;
    }
    .btn{
      width:100%; border:none; border-radius:10px; padding:12px;
      background:var(--accent); color:#fff; font-weight:600; cursor:pointer;
    }
    .btn:hover{ filter:brightness(1.05) }
    .btn-row{ display:flex; gap:10px }
    .btn.secondary{
      background:transparent; border:2px solid var(--accent); color:var(--accent);
    }

    .tooltip{ position:relative; display:flex; justify-content:center; width:100% }
    .tooltip .tooltiptext{
      position:absolute; bottom:150%; left:50%; transform:translateX(-50%);
      background:#555; color:#fff; padding:6px 8px; border-radius:6px; font-size:12px;
      opacity:0; visibility:hidden; transition:opacity .25s;
      white-space:nowrap;
    }
    .tooltip:hover .tooltiptext{ opacity:1; visibility:visible }
  </style>
</head>
<body>
  <div class="container">
    <h2>Player Data Input</h2>

    <div class="split-2">
      <div class="field">
        <div class="label">First Name <span class="required">*</span></div>
        <input id="firstName" type="text" oninput="capAndUpdate(this)">
      </div>
      <div class="field">
        <div class="label">Last Name <span class="required">*</span></div>
        <input id="lastName" type="text" oninput="capAndUpdate(this)">
      </div>
    </div>

    <div class="field">
      <div class="label">Current Club <span class="required">*</span></div>
      <input id="currentClub" type="text" oninput="capAndUpdate(this)">
      <div class="hint">Example: Arsenal (reserve line will be “Arsenal Reserves” by default)</div>
    </div>

    <div class="split-2">
      <div class="field">
        <div class="label">New First Name</div>
        <input id="newFirstName" type="text" oninput="capAndUpdate(this)">
      </div>
      <div class="field">
        <div class="label">New Last Name</div>
        <input id="newLastName" type="text" oninput="capAndUpdate(this)">
      </div>
    </div>

    <div class="field">
      <div class="label">New Short Name</div>
      <input id="newShortName" type="text" oninput="capAndUpdate(this)">
    </div>

    <div class="split-2">
      <div class="field">
        <div class="label">Year of Birth</div>
        <input id="yearOfBirth" type="number" inputmode="numeric" oninput="limitYear(this); updateResult();">
        <div class="hint">4 digits; player must be 15+ at game start</div>
      </div>
      <div class="field">
        <div class="label">New Club</div>
        <input id="newClub" type="text" oninput="capAndUpdate(this)">
      </div>
    </div>

    <div class="split-2">
      <div class="field">
        <div class="label">CA (0–100)</div>
        <input id="ca" type="number" min="0" max="100" inputmode="numeric" oninput="limitPercent(this); updateResult();">
        <div class="hint">Converted to 0–200 in result</div>
      </div>
      <div class="field">
        <div class="label">PA (0–100)</div>
        <input id="pa" type="number" min="0" max="100" inputmode="numeric" oninput="limitPercent(this); updateResult();">
        <div class="hint">Converted to 0–200 in result</div>
      </div>
    </div>

    <!-- Options: include reserves & suffix -->
    <div class="options">
      <label class="switch">
        <input id="includeReserves" type="checkbox" checked onchange="updateResult()">
        Include reserve line
      </label>
      <div class="row" style="gap:6px">
        <span class="label" style="margin:0">Suffix</span>
        <input id="reserveSuffix" type="text" value="Reserves" style="width:150px" oninput="capAndUpdate(this)">
      </div>
      <div class="spacer"></div>
      <div class="hint">Outputs two lines: main squad + current club with the suffix (e.g., “Arsenal Reserves”).</div>
    </div>

    <div class="result-label">Result</div>
    <div id="result" contenteditable="true"></div>

    <div class="btn-row">
      <div class="tooltip" style="flex:1">
        <button class="btn" onclick="copyResult()" onmouseout="resetTip()">Copy Result</button>
        <span class="tooltiptext" id="tip">Copy to clipboard</span>
      </div>
      <button class="btn secondary" onclick="clearAll()">Clear Inputs</button>
    </div>
  </div>

  <script>
    // --- helpers ---
    function capAndUpdate(el){
      if (el.value) el.value = el.value.charAt(0).toUpperCase() + el.value.slice(1);
      updateResult();
    }
    function limitPercent(el){
      if(el.value === "") return;
      const v = Math.max(0, Math.min(100, Number(el.value)));
      el.value = isNaN(v) ? "" : v;
    }
    function limitYear(el){
      // keep only digits and cap length 4; also clamp reasonable range if present
      el.value = el.value.replace(/\D/g,'').slice(0,4);
    }
    function to200scale(x){
      if(x === "" || isNaN(Number(x))) return "";
      const n = Math.max(0, Math.min(100, Number(x)));
      return Math.round((n/100)*200);
    }

    // Build a single line given a specific "club" value
    function lineForClub(club){
      const first   = document.getElementById("firstName").value.trim();
      const last    = document.getElementById("lastName").value.trim();
      const newFirst= document.getElementById("newFirstName").value;
      const newLast = document.getElementById("newLastName").value;
      const shortNm = document.getElementById("newShortName").value;
      const year    = document.getElementById("yearOfBirth").value;
      const ca200   = to200scale(document.getElementById("ca").value);
      const pa200   = to200scale(document.getElementById("pa").value);
      const newClub = document.getElementById("newClub").value;

      return `"PLAYER" "${first}" "${last}" "${club}" "${newFirst}" "${newLast}" "${shortNm}" "${year}" "${ca200}" "${pa200}" "${newClub}"`;
    }

    function updateResult(){
      const first = document.getElementById("firstName").value.trim();
      const last = document.getElementById("lastName").value.trim();
      const currentClub = document.getElementById("currentClub").value.trim();
      const includeRes = document.getElementById("includeReserves").checked;
      const suffix = document.getElementById("reserveSuffix").value.trim() || "Reserves";

      const resultEl = document.getElementById("result");

      // only show result if important fields are filled
      if(!first || !last || !currentClub){
        resultEl.textContent = "";
        return;
      }

      const lines = [];
      // main line
      lines.push(lineForClub(currentClub));

      // reserve line
      if(includeRes){
        const reserveClub = `${currentClub} ${suffix}`.trim();
        lines.push(lineForClub(reserveClub));
      }

      // add a blank line after (two newlines)
      resultEl.textContent = lines.join("\n") + "\n\n";
    }

    async function copyResult(){
      const text = document.getElementById("result").textContent.trim();
      if(!text) return;
      try{
        await navigator.clipboard.writeText(text);
        const tip = document.getElementById("tip");
        tip.textContent = "Copied!";
      }catch(e){
        alert("Copy failed: " + e);
      }
    }
    function resetTip(){ document.getElementById("tip").textContent = "Copy to clipboard"; }

    function clearAll(){
      const ids = ["firstName","lastName","currentClub","newFirstName","newLastName","newShortName","yearOfBirth","ca","pa","newClub"];
      ids.forEach(id => document.getElementById(id).value = "");
      // keep includeReserves & suffix as user preference
      document.getElementById("result").textContent = "";
    }

    // initialize
    updateResult();
  </script>
</body>
</html>
